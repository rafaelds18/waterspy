%%_______________________________________________________________________
\chapter{Validações e Testes}
\label{ch:validacaoTestes}
%%________________________________________________________________________

Neste capitulo apresentam-se em várias secções os vários ecrãs que constituem o sistema \texttt{WaterSpy}, que demonstram as validações e testes que foram efetuados ao sistema \texttt{WaterSpy}. Para validações e testes o sistema foi hospedado nos servidores \textit{Heroku} \cite{Heroku}, e encontra-se disponível no seguinte endereço \url{https://waterspy.herokuapp.com}.

\section{\textit{Login}}
\label{sec:loginValTests}
Na \autoref{fig:loginValTests} é apresentado o ecrã de \texttt{Login}, o primeiro ecrã com que o utilizador se depara e onde terá de fazer a autenticação para poder entrar no sistema. Para tal o utilizador terá de se registar primeiro, ecrã que será apresentado na \autoref{sec:registerValTests}. 
\begin{figure}[!ht]
	\centering
	\includegraphics[width=4.5cm]{Imagens/ValidacoesTestes/Login-ValTests.pdf}
	\caption{Ecrã de Validação/Teste do \textit{Login}}
	\label{fig:loginValTests}
\end{figure}

Caso o utilizador tente entrar com uma conta que não existe, ou o \textit{e-mail} não tenha sido confirmado, ou tente entrar com senha errada ou com uma conta que tenha sido apagada não irá conseguir entrar no sistema. Neste ecrã ao fazer \textit{login} poderá ir para o \textit{front-office} caso entre como consumidor ou para o \textit{back-office} caso entre como administrador.

\newpage
\section{Registar Utilizador}
\label{sec:registerValTests}
Na \autoref{fig:registerValTests} é apresentado o ecrã de \texttt{Registar Utilizador}, em que o utilizador terá  de preencher todos os dados corretamente para ficar registado no sistema, para poder autenticar-se e poder usufruir do mesmo. 
\begin{figure}[!ht]
	\centering
	\includegraphics[width=4.5cm]{Imagens/ValidacoesTestes/Register-User-ValTests.pdf}
	\caption{Ecrã de Validação/Teste de Registo do Utilizador}
	\label{fig:registerValTests}
\end{figure}

\newpage
Após o registo o utilizador irá receber um \textit{e-mail} de confirmação de conta na sua caixa de entrada do \textit{e-mail} que usou para o registo, só após carregar no \textit{url} do \textit{e-mail} recebido é que irá poder autenticar-se no sistema com sucesso.

\section{Página Principal}
\label{sec:homeValTests}
Na \autoref{fig:home_menu_valTests} é apresentado o ecrã principal na  \autoref{subFig:homeValTests} e o menu na \autoref{subFig:homeMenuValTests}. 
\begin{figure}[!ht]
    \centering
    \subfloat[\centering Ecrã Principal - Página Principal
    \label{subFig:homeValTests}]
    {{\includegraphics[width=4cm]{Imagens/ValidacoesTestes/Home-ValTests.pdf} }}
    \qquad
    \subfloat[\centering Ecrã Principal - \textit{Menu}
     \label{subFig:homeMenuValTests}]
    {{\includegraphics[width=4cm]{Imagens/ValidacoesTestes/Home-Menu-ValTests.pdf} }}    
    \caption{Imagens do Ecrã Principal - Página Principal e \textit{Menu}}
    \label{fig:home_menu_valTests}
\end{figure}

No ecrã principal é possível ver o consumo médio, que é calculado em função dos envios que o utilizador faz. Através de um gráfico com uma agulha, que indica se está a exceder a média dos seus consumos, o utilizador pode controlar melhor os seus consumos de água, este gráfico é mostrado por percentagem de consumo, sendo os 100\%, o valor mais alto do consumo e 0\% o valor mais baixo.
Através de outro gráfico, neste caso de barras é possível ver o consumo de todos os meses que foi efetuado. 

É possível observar no navbar que existe um menu onde se encontram todas as suas opções como o símbolo de uma casa que redireciona para a página principal, o \texttt{Perfil de Utilizador} e a opção ao lado da fotografia com o \texttt{"Nome do Utilizador Autenticado"} redirecionam ambas para a página de perfil do utilizador, a opção \texttt{Registar} redireciona para a página de registo de contratos, a opção \texttt{Consultar} têm duas sub-opções \texttt{Consumos} e \texttt{Contratos} em que redirecionam para as páginas consultar consumos e consultar contratos, a opção \texttt{Enviar Consumos} para a página que permite enviar os consumos efetuados, a opção \texttt{Notificações} que permite ver as notificações recebidas e a opção com um símbolo de uma porta com uma seta para a direita para terminar a sessão.


\section{Perfil de Utilizador}
\label{sec:perfilValTests}
Na \autoref{fig:perfilValTests} é apresentado o ecrã de \texttt{Perfil de Utilizador} que apresenta todas as informações sobre os dados de conta do utilizador, esses mesmos dados são editáveis, como também é possível editar a imagem de perfil com a exceção do \texttt{e-mail} não é editável, por ser o elemento que se usa para autenticação do sistema. 
\begin{figure}[!ht]
	\centering
	\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Perfil-ValTests.pdf}
	\caption{Ecrã de Validação/Teste do Perfil de Utilizador}
	\label{fig:perfilValTests}
\end{figure}

\newpage
\section{Registo de Contratos}
\label{sec:registerContractValTests}
Na \autoref{fig:registerContractValTests} é apresentado o ecrã de \texttt{Registo de Contratos} onde é possível o utilizador registar os vários contratos que tenha e associar os contadores aos mesmos.
Para o registo de um contrato é necessário uma \texttt{Descrição}, que será a forma mais fácil para o utilizador identificar a que local pertence aquele contrato, é necessário o \texttt{Número de Contrato} e escolher o \texttt{Fornecedor} que está associado ao contrato. Poderá dar-se o caso de o \texttt{Fornecedor} não estar presente, nesse caso é porque o sistema \texttt{WaterSpy} não tem nenhuma integração com esse \texttt{Fornecedor}. Um dado opcional é associar um contador ao contrato no momento de registo do contrato, assim o utilizador poderá ou não associar um ou mais contadores. No caso de não associar nenhum poderá fazê-lo mais tarde na \texttt{Consulta de Contratos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Register-Contract-ValTests.pdf}
	\caption{Ecrã de Validação/Teste do Registo de Contratos}
	\label{fig:registerContractValTests}
\end{figure}

\section{Consultar}
\label{sec:consultingValTests}
Nesta \autoref{sec:consultingValTests} está presente as \autoref{subsec:consultingConsumptionsValTests} e a \autoref{subsec:consultingContractsValTests}, nas quais é possível verificar os consumos feitos e os contratos associados a conta do utilizador.

\subsection{Consumos}
\label{subsec:consultingConsumptionsValTests}
Na \autoref{fig:consultingConsumptionsValTests} são apresentados dois tipos de visualizações dos consumos enviados pelos utilizadores. A \autoref{subFig:consultingWeekConsumptionsValTests} representa os consumos efetuados na semana presente e a \autoref{subFig:consultingMonthConsumptionsValTests} representa os consumos efetuados no mês mas com a opção de poder escolher outros meses para ver como foram os seus consumos.
\begin{figure}[!ht]
    \centering
    \subfloat[\centering Ecrã Consulta de Consumos - Consumo Semanal
    \label{subFig:consultingWeekConsumptionsValTests}]
    {{\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Consulting-Consumptions-Week-ValTests.pdf} }}
    \qquad
    \subfloat[\centering Ecrã Consulta de Consumos - Consumo Mensal
     \label{subFig:consultingMonthConsumptionsValTests}]
    {{\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Consulting-Consumptions-Month-ValTests.pdf} }}    
    \caption{Ecrã de Consulta dos Consumos}
    \label{fig:consultingConsumptionsValTests}
\end{figure}

\newpage
\subsection{Contratos}
\label{subsec:consultingContractsValTests}
Na \autoref{fig:consultingContractsValTests} é apresentado todos os contratos registados na conta do utilizador, contendo a \texttt{Descrição}, \texttt{Número de Contrato} e \texttt{Fornecedor} também é possível visualizar com mais detalhe os contratos e edita-los para poder associar contadores.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Consulting-Contracts-ValTests.pdf}
	\caption{Ecrã de Validação/Teste de \textit{Consulta de Contratos}}
	\label{fig:consultingContractsValTests}
\end{figure}

\newpage
\section{Enviar Consumos}
\label{sec:sendConsumptionsValTests}
Na \autoref{fig:sendConsumptionsValTests} são apresentados os dois modos de envio de consumos que o sistema \texttt{WaterSpy} permite. A \autoref{subFig:sendConsumptionsByTextValTests} representa o envio de consumo por texto que pode ser usado no caso do utilizador estar num ambiente em que a câmara fotográfica não tenha a melhor qualidade ou por algum motivo não funcione ou ainda caso o valor interpretado pelo \textit{OCR} não esteja correto. A \autoref{subFig:sendConsumptionsByCameraValTests} representa o envio de consumos por fotografia, onde neste caso existem duas possibilidades, tirar fotografia ao leitor e guardar no seu \textit{SmartPhone} e mais tarde na opção escolher o ficheiro submeter para a análise do \textit{OCR}. A outra possibilidade é retirar uma foto no momento e proceder para análise do \textit{OCR} e enviar a mesma.
\begin{figure}[!ht]
    \centering
    \subfloat[\centering Ecrã Envio de Consumos - Envio por Texto
    \label{subFig:sendConsumptionsByTextValTests}]
    {{\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Send-Consumptions-ValTests.pdf} }}
    \qquad
    \subfloat[\centering Ecrã Envio de Consumos - Envio por Fotografia
     \label{subFig:sendConsumptionsByCameraValTests}]
    {{\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Send-Consumptions-Camera-ValTests.pdf} }}    
    \caption{Ecrã de Envio de Consumos}
    \label{fig:sendConsumptionsValTests}
\end{figure}

\newpage
Para melhor precisão do \textit{OCR} deve-se reunir um conjunto de fatores/condições como estar num ambiente que não seja muito escuro ao ponto da fotografia não ser percetível e só retirar fotografia aos valores do leitor excluindo os últimos que estejam a vermelho.

Para realização de testes sempre que é enviado um consumo é recebido por parte do \texttt{Sistema Gestão de Consumos} uma resposta. Resposta essa que fica a cargo do sistema \texttt{WaterSpy} enviar um email para o utilizador \autoref{fig:emailValTests}, a indicar por exemplo: "Foi recebido com sucesso a sua leitura de $670m^{3}$".

\begin{figure}[!ht]
	\centering
	\includegraphics[width=13cm]{Imagens/ValidacoesTestes/Email-Consumption-ValTests.pdf}
	\caption{Email recebido por parte do Sistema}
	\label{fig:emailValTests}
\end{figure}

\newpage
\section{Notificações}
\label{sec:notificationsValTests}
Na \autoref{fig:notificationsValTests} apresenta o ecrã de \texttt{Notificações} que utilizador recebeu seja por parte dos administradores do sistema \texttt{WaterSpy} seja respostas por parte do \texttt{Sistema Gestão de Consumos}.
\begin{figure}[!ht]
	\centering
	\includegraphics[width=5cm]{Imagens/ValidacoesTestes/Notification-ValTests.pdf}
	\caption{Ecrã de Validação/Teste das Notificações}
	\label{fig:notificationsValTests}
\end{figure}
